server:
  port: 8080

spring:
  application:
    name: document-hub-poc

  # R2DBC Database Configuration
  r2dbc:
    url: r2dbc:postgresql://localhost:5432/documenthub
    username: postgres
    password: postgres
    pool:
      initial-size: 10
      max-size: 50
      max-idle-time: 30m
      validation-query: SELECT 1

  # Redis Configuration
  data:
    redis:
      host: localhost
      port: 6379
      password:
      lettuce:
        pool:
          max-active: 20
          max-idle: 10
          min-idle: 5
          max-wait: 2000ms

# Integration Service URLs
integration:
  services:
    account-service:
      base-url: http://localhost:8081
      timeout: 5000
    customer-service:
      base-url: http://localhost:8082
      timeout: 5000
    pricing-service:
      base-url: http://localhost:8083
      timeout: 5000
    transaction-service:
      base-url: http://localhost:8084
      timeout: 5000

# WebClient Configuration
webclient:
  max-connections: 500
  max-pending-acquires: 1000
  connect-timeout: 5000
  read-timeout: 10000

# Circuit Breaker Configuration
resilience4j:
  circuitbreaker:
    configs:
      default:
        registerHealthIndicator: true
        slidingWindowSize: 10
        minimumNumberOfCalls: 5
        failureRateThreshold: 50
        waitDurationInOpenState: 60s
        permittedNumberOfCallsInHalfOpenState: 3
        automaticTransitionFromOpenToHalfOpenEnabled: true
    instances:
      accountService:
        baseConfig: default
      customerService:
        baseConfig: default
      pricingService:
        baseConfig: default

  retry:
    configs:
      default:
        maxAttempts: 3
        waitDuration: 500ms
        retryExceptions:
          - java.net.ConnectException
          - java.net.SocketTimeoutException
    instances:
      accountService:
        baseConfig: default
      customerService:
        baseConfig: default

# Caching Configuration
cache:
  default-ttl: 1800  # 30 minutes in seconds
  enabled: true

# Logging
logging:
  level:
    root: INFO
    io.swagger: DEBUG
    org.springframework.r2dbc: DEBUG
    io.r2dbc.postgresql.QUERY: DEBUG
    reactor.netty.http.client: DEBUG

# Application-specific settings
app:
  extraction:
    max-steps: 10
    default-timeout: 5000
    parallel-execution-enabled: true
  matching:
    max-results-per-template: 100
  pagination:
    default-page-size: 20
    max-page-size: 100
